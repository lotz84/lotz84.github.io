<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Haskell から MySQL を使う</title>
        <meta name="viewport" content="width=device-width" />
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lora" />
        <link rel="stylesheet" href="../css/kube.min.css" />
        <link rel="stylesheet" href="../css/prism.css" />
        <link rel="stylesheet" href="../css/main.css" />
        <link rel="stylesheet" href="../font/octicons.css" />
        <script type="text/javascript" src="../js/prism.js"></script>
    </head>
    <body>
        <div class="units-row units-padding">
            <div class="unit-20 sidemenu">
                <h1><a href="../">flip map <img src="../img/samurai.png" style="margin:-15px 0 0 -30px;width:60px"></a></h1>
                <p><a href="https://placekitten.com/"><img src="https://placekitten.com/g/200/160"></a></p>
                <h2>Index</h2>
                <ul>
                    <li><a href="../about"><span class="octicon octicon-person"></span> About</a></li>
                    <li><a href="../posts"><span class="octicon octicon-file-text"></span> Blog</a></li>
                    <li><a href="https://github.com/lotz84" target="blank_"><span class="octicon octicon-mark-github"></span> Github</a></li>
                    <li><a href="https://twitter.com/lotz84_" target="blank_"><span class="octicon octicon-mention"></span> Twitter</a></li>
                    <li><a href="../feed.xml" target="blank_"><span class="octicon octicon-rss"></span> RSS</a></li>
                </ul>
            </div>
            <div class="unit-80 entry-body-main">
                <h1><a href="../posts/use-mysql-from-haskell">Haskell から MySQL を使う</a></h1>
<p>2014/12/01</p>
<p>ひょんなことからHaskellで簡単な掲示板を作る機会があったので その時に覚えた<a href="https://hackage.haskell.org/package/mysql-simple">mysql-simple</a>の使い方を書き留めておこうと思います。</p>
<h2 id="環境構築">環境構築</h2>
<p>テスト用のディレクトリとcabalファイルを作ってmysql-simpleを入れます</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">mkdir</span> mysql-test <span class="kw">&amp;&amp;</span> <span class="kw">cd</span> mysql-test
$ <span class="kw">cabal</span> sandbox init</code></pre></div>
<p>mysql-test.cabal を作ります。これはライブラリの依存関係を記述するファイルです。</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">vim</span> mysql-test.cabal</code></pre></div>
<pre class="markup"><code>name: mysql-test
version: 0.0.0.1
build-type: Simple
cabal-version: &gt;=1.20

executable app
  main-is: app.hs
  build-depends: base, mysql-simple
  ghc-options: -Wall
  default-language: Haskell2010</code></pre>
<p>依存ライブラリをインストールしましょう。</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cabal</span> install --only-dependencies</code></pre></div>
<p>実際にアプリケーションを書いていきます</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">vim</span> app.hs</code></pre></div>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> connect defaultConnectInfo
  [<span class="dt">Only</span> i] <span class="ot">&lt;-</span> query_ conn <span class="st">&quot;select 2 + 2&quot;</span>
  print (<span class="ot">i ::</span> <span class="dt">Int</span>)</code></pre></div>
<p>実行します。このときMySQLサーバーが立ち上がってることを確認して下さい。</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cabal</span> run app
<span class="kw">4</span></code></pre></div>
<p><code>4</code> が表示されれば成功です！</p>
<p>テスト用のDBを作っておきましょう。</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">mysql</span> -uroot
<span class="kw">mysql&gt;</span> CREATE DATABASE mysql_test<span class="kw">;</span>
<span class="kw">mysql&gt;</span> USE mysql_test<span class="kw">;</span>
<span class="kw">mysql&gt;</span> CREATE TABLE user (id int unsigned, name varchar(255), <span class="kw">PRIMARY</span> KEY (id));</code></pre></div>
<h2 id="crud">CRUD</h2>
<h3 id="create">CREATE</h3>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }
  execute conn <span class="st">&quot;INSERT INTO user VALUES (?, ?)&quot;</span> (<span class="dv">1</span><span class="ot"> ::</span> <span class="dt">Int</span>, <span class="st">&quot;a&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)
  return ()</code></pre></div>
<p>実行すると確かにデータが挿入されているはずです</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">mysql&gt;</span> SELECT * FROM user<span class="kw">;</span>
<span class="kw">+----+------+</span>
<span class="kw">|</span> <span class="kw">id</span> <span class="kw">|</span> <span class="kw">name</span> <span class="kw">|</span>
<span class="kw">+----+------+</span>
<span class="kw">|</span>  <span class="kw">1</span> <span class="kw">|</span> <span class="kw">a</span>    <span class="kw">|</span>
<span class="kw">+----+------+</span></code></pre></div>
<p>main関数を一行ずつ見て行きましょう 最初の行はMySQLとの接続をしています</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">conn <span class="ot">&lt;-</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }</code></pre></div>
<p><code>connect</code>と<code>defaultConnectInfo</code>の情報を調べてみましょう。</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">ghci</span>
<span class="kw">Prelude&gt;</span> :m Database.MySQL.Simple

<span class="kw">Prelude&gt;</span> :t connect
<span class="kw">connect</span> :: ConnectInfo -<span class="kw">&gt;</span> IO Connection

<span class="kw">Prelude&gt;</span> :t defaultConnectInfo
<span class="kw">defaultConnectInfo</span> :: ConnectInfo

<span class="kw">Prelude&gt;</span> :i ConnectInfo
<span class="kw">data</span> ConnectInfo
  = <span class="kw">ConnectInfo</span> {connectHost :: String,
                 <span class="kw">connectPort</span> :: GHC.Word.Word16,
                 <span class="kw">connectUser</span> :: String,
                 <span class="kw">connectPassword</span> :: String,
                 <span class="kw">connectDatabase</span> :: String,
                 <span class="kw">connectOptions</span> :: [Database.MySQL.Base.Types.Option],
                 <span class="kw">connectPath</span> :: FilePath,
                 <span class="kw">connectSSL</span> :: Maybe Database.MySQL.Base.SSLInfo}

<span class="kw">Prelude&gt;</span> defaultConnectInfo
<span class="kw">ConnectInfo</span> {connectHost = <span class="st">&quot;localhost&quot;</span>, connectPort = 3306, connectUser = <span class="st">&quot;root&quot;</span>, connectPassword = <span class="st">&quot;&quot;</span>, connectDatabase = <span class="st">&quot;test&quot;</span>, connectOptions = [CharsetName <span class="st">&quot;utf8&quot;</span>], connectPath = <span class="st">&quot;&quot;</span>, connectSSL = Nothing}</code></pre></div>
<p>ここまで見れば明らかですが<a href="https://hackage.haskell.org/package/mysql-simple/docs/Database-MySQL-Simple.html#v:defaultConnectInfo">defaultConnectInfo</a>は<a href="https://hackage.haskell.org/package/mysql-simple-0.2.2.4/docs/Database-MySQL-Simple.html#t:ConnectInfo">ConnectInfo</a>型でこれはMySQLに接続するために必要な情報を格納するレコードです。<a href="https://hackage.haskell.org/package/mysql-simple/docs/Database-MySQL-Simple.html#v:connect">connect</a>はこれを引数にとってMySQLと接続するための関数です。<code>defaultConnectInfo</code>のままでは<code>test</code>のDBを見に行ってしまうのでレコード構文を使って先ほど作ったDBを見に行くように変えています。</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }</code></pre></div>
<p>次の行は実際にデータを挿入しているところです</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">execute conn <span class="st">&quot;INSERT INTO user VALUES (?, ?)&quot;</span> (<span class="dv">1</span><span class="ot"> ::</span> <span class="dt">Int</span>, <span class="st">&quot;a&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)</code></pre></div>
<p>mysql-simpleには<a href="https://hackage.haskell.org/package/mysql-simple/docs/Database-MySQL-Simple.html#v:query">query</a>と<a href="https://hackage.haskell.org/package/mysql-simple/docs/Database-MySQL-Simple.html#v:execute">execute</a>の２つのクエリを実行する関数があります。queryはSELECT文のように何か結果を返すようなクエリの実行に、executeはINSERTやUPDATEのような何も結果を返さないようなクエリの実行に使います。今回はINSERTなのでexecuteを使っています。 クエリの中の“?”は後の引数のタプルの要素がサニタイジングされて代入されます。クエリ中の“?”の個数とタプルの要素数は一致していないといけません。 <code>(1 :: Int, &quot;a&quot; :: String)</code>の部分は少し見にくいですが本質的には(1,“a”)のタプルで、リテラルだと型がわからないので型注釈が入った形になっています。</p>
<p>最後の</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">return ()</code></pre></div>
<p>の行はmain関数の型を合わせるために入っています。</p>
<p>一気に十人ぐらいのデータを入れてみましょう。</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Control.Monad</span>
<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }
  forM (zip [<span class="dv">2</span><span class="fu">..</span><span class="dv">10</span>] [<span class="ch">'b'</span><span class="fu">..</span>]) <span class="fu">$</span> \(n, c) <span class="ot">-&gt;</span> <span class="kw">do</span>
    execute conn <span class="st">&quot;INSERT INTO user VALUES (?, ?)&quot;</span> (<span class="ot">n ::</span> <span class="dt">Int</span>, [c])
  return ()</code></pre></div>
<h3 id="read">READ</h3>
<p>先ほど入れたデータを今度は読んでみましょう</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }
  rs <span class="ot">&lt;-</span> query_ conn <span class="st">&quot;SELECT * FROM user&quot;</span>
  mapM_ putStrLn <span class="fu">$</span> map show (<span class="ot">rs ::</span> [(<span class="dt">Int</span>, <span class="dt">String</span>)])</code></pre></div>
<p>実行すると</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cabal</span> run app
<span class="kw">(1</span>,<span class="st">&quot;a&quot;</span><span class="kw">)</span>
<span class="kw">(2</span>,<span class="st">&quot;b&quot;</span><span class="kw">)</span>
<span class="kw">(3</span>,<span class="st">&quot;c&quot;</span><span class="kw">)</span>
<span class="kw">(4</span>,<span class="st">&quot;d&quot;</span><span class="kw">)</span>
<span class="kw">(5</span>,<span class="st">&quot;e&quot;</span><span class="kw">)</span>
<span class="kw">(6</span>,<span class="st">&quot;f&quot;</span><span class="kw">)</span>
<span class="kw">(7</span>,<span class="st">&quot;g&quot;</span><span class="kw">)</span>
<span class="kw">(8</span>,<span class="st">&quot;h&quot;</span><span class="kw">)</span>
<span class="kw">(9</span>,<span class="st">&quot;i&quot;</span><span class="kw">)</span>
<span class="kw">(10</span>,<span class="st">&quot;j&quot;</span><span class="kw">)</span></code></pre></div>
<p>ちゃんと表示されると思います。</p>
<p><a href="https://hackage.haskell.org/package/mysql-simple-0.2.2.4/docs/Database-MySQL-Simple.html#v:query_">query_</a>, <a href="https://hackage.haskell.org/package/mysql-simple-0.2.2.4/docs/Database-MySQL-Simple.html#v:execute_">execute_</a>はquery, executeとほとんど同じですが、クエリ中に“?”が無くタプルを引数としてとらない場合に使います。 実行結果は<code>(rs :: [(Int, String)])</code>のように正しく型付けしてやる必要があります。</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">type</span> <span class="dt">User</span> <span class="fu">=</span> (<span class="dt">Int</span>, <span class="dt">String</span>)</code></pre></div>
<p>のようにしておけば<code>(rs :: [User])</code>のように書くことも出来ます。</p>
<h3 id="update-delete">UPDATE, DELETE</h3>
<p>ここまでくればUPDATEとDELETEは自然に書けると思います。</p>
<h4 id="update">UPDATE</h4>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }
  execute_ conn <span class="st">&quot;UPDATE user SET name = 'aa' WHERE id = 1&quot;</span>
  return ()</code></pre></div>
<h4 id="delete">DELETE</h4>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }
  execute_ conn <span class="st">&quot;DELETE FROM user WHERE id = 10&quot;</span>
  return ()</code></pre></div>
<h2 id="簡単なアプリを作ってみる">簡単なアプリを作ってみる</h2>
<p>最後にさっき作った<code>user</code>テーブルを読み書きするだけの簡単なアプリを作ってみます</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="kw">import </span><span class="dt">Control.Monad</span>
<span class="kw">import </span><span class="dt">Database.MySQL.Simple</span>

<span class="kw">type</span> <span class="dt">User</span> <span class="fu">=</span> (<span class="dt">Int</span>, <span class="dt">String</span>)

<span class="ot">getConnection::</span> <span class="dt">IO</span> <span class="dt">Connection</span>
getConnection <span class="fu">=</span> connect defaultConnectInfo { connectDatabase <span class="fu">=</span> <span class="st">&quot;mysql_test&quot;</span> }

<span class="ot">mySelect ::</span> <span class="dt">IO</span> ()
mySelect <span class="fu">=</span> <span class="kw">do</span>
  conn <span class="ot">&lt;-</span> getConnection
  rs   <span class="ot">&lt;-</span> query_ conn <span class="st">&quot;SELECT * FROM user&quot;</span>
  mapM_ putStrLn <span class="fu">$</span> map show (<span class="ot">rs ::</span> [<span class="dt">User</span>])

<span class="ot">myInsert ::</span> <span class="dt">IO</span> ()
myInsert <span class="fu">=</span> <span class="kw">do</span>
  putStrLn <span class="st">&quot;Data: &quot;</span>
  input <span class="ot">&lt;-</span> getLine
  <span class="kw">let</span> user <span class="fu">=</span> (read <span class="fu">$</span> concat [<span class="st">&quot;(&quot;</span>, input, <span class="st">&quot;)&quot;</span>])<span class="ot"> ::</span> <span class="dt">User</span>
  conn <span class="ot">&lt;-</span> getConnection
  execute conn <span class="st">&quot;INSERT INTO user VALUES (?, ?)&quot;</span> user
  return ()

<span class="ot">myUpdate ::</span> <span class="dt">IO</span> ()
myUpdate <span class="fu">=</span> <span class="kw">do</span>
  putStrLn <span class="st">&quot;Data: &quot;</span>
  input <span class="ot">&lt;-</span> getLine
  <span class="kw">let</span> (n, name) <span class="fu">=</span> (read <span class="fu">$</span> concat [<span class="st">&quot;(&quot;</span>, input, <span class="st">&quot;)&quot;</span>])<span class="ot"> ::</span> <span class="dt">User</span>
  conn <span class="ot">&lt;-</span> getConnection
  execute conn <span class="st">&quot;UPDATE user SET name = ? WHERE id = ?&quot;</span> (name, n)
  return ()

<span class="ot">myDelete ::</span> <span class="dt">IO</span> ()
myDelete <span class="fu">=</span> <span class="kw">do</span>
  putStrLn <span class="st">&quot;ID: &quot;</span>
  input <span class="ot">&lt;-</span> getLine
  <span class="kw">let</span> n <span class="fu">=</span> read<span class="ot"> input ::</span> <span class="dt">Int</span>
  conn <span class="ot">&lt;-</span> getConnection
  execute conn <span class="st">&quot;DELETE FROM user WHERE id = ?&quot;</span> (<span class="dt">Only</span> n)
  return ()

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  putStrLn <span class="st">&quot;Command: &quot;</span>
  command <span class="ot">&lt;-</span> getLine
  <span class="kw">case</span> command <span class="kw">of</span>
    <span class="st">&quot;show&quot;</span>   <span class="ot">-&gt;</span> mySelect <span class="fu">&gt;&gt;</span> main
    <span class="st">&quot;insert&quot;</span> <span class="ot">-&gt;</span> myInsert <span class="fu">&gt;&gt;</span> main
    <span class="st">&quot;update&quot;</span> <span class="ot">-&gt;</span> myUpdate <span class="fu">&gt;&gt;</span> main
    <span class="st">&quot;delete&quot;</span> <span class="ot">-&gt;</span> myDelete <span class="fu">&gt;&gt;</span> main
    <span class="st">&quot;exit&quot;</span>   <span class="ot">-&gt;</span> putStrLn <span class="st">&quot;Bye.&quot;</span> <span class="fu">&gt;&gt;</span> return ()
    _        <span class="ot">-&gt;</span> putStrLn <span class="st">&quot;Command: show, insert, update, deletem or exit&quot;</span> <span class="fu">&gt;&gt;</span> main</code></pre></div>
<p>実際にコピペして実行してみてください。 以下のような感じで遊ぶことが出来ます</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="fu">$</span> cabal run app
<span class="dt">Command</span><span class="fu">:</span>
show
(<span class="dv">1</span>,<span class="st">&quot;aa&quot;</span>)
(<span class="dv">2</span>,<span class="st">&quot;b&quot;</span>)
(<span class="dv">3</span>,<span class="st">&quot;c&quot;</span>)
(<span class="dv">4</span>,<span class="st">&quot;d&quot;</span>)
(<span class="dv">5</span>,<span class="st">&quot;e&quot;</span>)
(<span class="dv">6</span>,<span class="st">&quot;f&quot;</span>)
(<span class="dv">7</span>,<span class="st">&quot;g&quot;</span>)
(<span class="dv">8</span>,<span class="st">&quot;h&quot;</span>)
(<span class="dv">9</span>,<span class="st">&quot;i&quot;</span>)
<span class="dt">Command</span><span class="fu">:</span>
insert
<span class="dt">Data</span><span class="fu">:</span>
<span class="dv">10</span>, <span class="st">&quot;haskell&quot;</span>
<span class="dt">Command</span><span class="fu">:</span>
delete
<span class="dt">ID</span><span class="fu">:</span>
<span class="dv">8</span>
<span class="dt">Command</span><span class="fu">:</span>
show
(<span class="dv">1</span>,<span class="st">&quot;aa&quot;</span>)
(<span class="dv">2</span>,<span class="st">&quot;b&quot;</span>)
(<span class="dv">3</span>,<span class="st">&quot;c&quot;</span>)
(<span class="dv">4</span>,<span class="st">&quot;d&quot;</span>)
(<span class="dv">5</span>,<span class="st">&quot;e&quot;</span>)
(<span class="dv">6</span>,<span class="st">&quot;f&quot;</span>)
(<span class="dv">7</span>,<span class="st">&quot;g&quot;</span>)
(<span class="dv">9</span>,<span class="st">&quot;i&quot;</span>)
(<span class="dv">10</span>,<span class="st">&quot;haskell&quot;</span>)
<span class="dt">Command</span><span class="fu">:</span>
exit
<span class="dt">Bye</span><span class="fu">.</span></code></pre></div>
<div>
    <a href="http://b.hatena.ne.jp/entry/" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加" class="hatena-bookmark-button"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;"></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.3";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script><div data-layout="button_count" data-action="like" data-show-faces="false" data-share="false" class="fb-like"></div>
</div>

<div class="hatena-bookmark-marker"></div>

<script type="text/javascript" charset="utf-8" src="http://b.hatena.ne.jp/js/bookmark_blogparts.js"></script>
<script type="text/javascript">
HBBlogParts.commentInsertSelector = [ 'div.hatena-bookmark-marker'];
HBBlogParts.permalinkSelector = [ 'div.entry-body-main h1 a'];
HBBlogParts.permalinkAttribute = 'href';
HBBlogParts.permalinkPathRegexp = /\/posts\/.*\.html/;
</script>

            </div>
        </div>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-38246049-16', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</html>
